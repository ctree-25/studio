
{
  "entities": {
    "PlayerProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PlayerProfile",
      "type": "object",
      "description": "Represents a volleyball player's profile, including their personal information, athletic details, and target schools.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the player profile."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 PlayerProfile)"
        },
        "name": {
          "type": "string",
          "description": "The player's full name."
        },
        "position": {
          "type": "string",
          "description": "The player's primary volleyball position."
        },
        "height": {
          "type": "string",
          "description": "The player's height."
        },
        "gradYear": {
          "type": "string",
          "description": "The player's high school graduation year."
        },
        "targetLevel": {
          "type": "string",
          "description": "The player's target level of play (e.g., D1, D2, D3)."
        },
        "preferredSchools": {
          "type": "string",
          "description": "A comma-separated string of the player's preferred schools."
        },
        "highlightVideoUrl": {
          "type": "string",
          "description": "URL to the player's highlight video."
        },
        "profilePictureUrl": {
          "type": "string",
          "description": "URL to the player's profile picture."
        }
      },
      "required": [
        "id",
        "userId",
        "name",
        "position",
        "height",
        "gradYear",
        "targetLevel",
        "preferredSchools",
        "highlightVideoUrl"
      ]
    },
    "Assessment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Assessment",
      "type": "object",
      "description": "Represents feedback and skill ratings provided by a coach for a player.",
      "properties": {
        "coachId": {
          "type": "string",
          "description": "The UID of the coach who created the assessment."
        },
        "playerId": {
          "type": "string",
          "description": "The UID of the player being assessed."
        },
        "feedbackText": {
          "type": "string",
          "description": "The qualitative feedback provided by the coach."
        },
        "skillRatings": {
          "type": "object",
          "description": "A map of skill names to numeric ratings (1-10).",
          "additionalProperties": {
            "type": "number"
          }
        },
        "timestamp": {
          "type": "string",
          "description": "The ISO 8601 timestamp of when the assessment was created.",
          "format": "date-time"
        }
      },
      "required": [
        "coachId",
        "playerId",
        "feedbackText",
        "skillRatings",
        "timestamp"
      ]
    },
    "Coach": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Coach",
      "type": "object",
      "description": "Represents a coach who can provide feedback on player profiles.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 Coach)"
        },
        "name": {
          "type": "string",
          "description": "The coach's full name."
        },
        "email": {
          "type": "string",
          "description": "The coach's email address.",
          "format": "email"
        },
        "affiliation": {
          "type": "string",
          "description": "The coach's school or club affiliation."
        },
        "experience": {
            "type": "string",
            "description": "Years of coaching experience."
        },
        "levelOfCoaching": {
            "type": "string",
            "enum": ["club", "hs-varsity", "college"],
            "description": "The primary level of coaching (e.g., club, high school, college)."
        },
        "phone": {
            "type": "string",
            "description": "The coach's contact phone number."
        },
        "placedPlayerLevels": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Levels at which the coach has previously placed players."
        },
        "profileLink": {
            "type": "string",
            "format": "uri",
            "description": "An optional link to a professional profile (e.g., LinkedIn)."
        },
        "profilesPerWeek": {
            "type": "string",
            "description": "The number of player profiles the coach is willing to review per week."
        }
      },
      "required": [
        "userId",
        "name",
        "email",
        "experience",
        "levelOfCoaching",
        "affiliation",
        "phone",
        "placedPlayerLevels",
        "profilesPerWeek"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application. Note: Authentication information (e.g., password) is not stored here.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the user, from Firebase Auth."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The user's role (e.g., player, coach)."
        }
      },
      "required": [
        "uid",
        "email",
        "role"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user information, including email and role. Key for role-based access control. Path-based ownership.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/playerProfiles/{playerProfileId}",
        "definition": {
          "entityName": "PlayerProfile",
          "schema": {
            "$ref": "#/backend/entities/PlayerProfile"
          },
          "description": "Stores player profile data. Includes denormalized 'userId' field for authorization independence. Allows players to manage their profiles.",
          "params": [
            {
              "name": "playerProfileId",
              "description": "The unique identifier for the player profile."
            }
          ]
        }
      },
      {
        "path": "/coaches/{coachId}",
        "definition": {
          "entityName": "Coach",
          "schema": {
            "$ref": "#/backend/entities/Coach"
          },
          "description": "Stores coach information, including name, email, and affiliation. Coaches can review assigned player profiles and provide feedback.",
          "params": [
            {
              "name": "coachId",
              "description": "The unique identifier for the coach."
            }
          ]
        }
      },
      {
        "path": "/assessments/{assessmentId}",
        "definition": {
          "entityName": "Assessment",
          "schema": {
            "$ref": "#/backend/entities/Assessment"
          },
          "description": "Stores individual assessments from a coach for a specific player.",
          "params": [
            {
              "name": "assessmentId",
              "description": "The unique identifier for the assessment."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to provide secure and efficient data access for the CourtConnect application. The key principle is Authorization Independence, achieved through denormalization and logical data separation.\n\nThe structure includes:\n\n*   `/users/{userId}`: Stores user information, including roles. This collection enables role-based access control.\n*   `/playerProfiles/{playerProfileId}`: Stores public player profile data.\n*   `/coaches/{coachId}`: Stores public coach information. \n*   `/assessments/{assessmentId}`: A top-level collection to store private feedback. This model simplifies security rules immensely. A coach can create an assessment, and a player can read assessments where their ID matches."
  }
}
